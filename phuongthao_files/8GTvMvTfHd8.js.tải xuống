;/*FB_PKG_DELIM*/

__d("MAsyncPageLoadWithGraphSearch",["Stratcom"],(function(a,b,c,d,e,f,g){"use strict";var h="graph-search-entry-point";function a(a){c("Stratcom").invoke("setSearchText",h,{title:a.searchTitle||""}),c("Stratcom").invoke("setCurrentProfileID",h,{profileID:a.currentProfileID})}g.pageLoad=a}),98);
__d("MFirefoxAppDetect",[],(function(a,b,c,d,e,f){function a(a,b){if(!navigator.mozApps){b();return}if(window.locationbar&&!window.locationbar.visible){a();return}if(navigator.mozApps.getSelf){var c=navigator.mozApps.getSelf();c.onsuccess=function(){c.result?a():b()};c.onerror=b}else b()}f.isFirefoxApp=a}),null);
__d("MPageHeaderRight",["MDOM","Stratcom"],(function(a,b,c,d,e,f,g){function h(){return d("MDOM").scry(document.body,"*","mChromeHeaderRight")[0]}function a(a){if(a){var b=h();b&&(d("MDOM").setContent(b,a.node||""),c("Stratcom").listen("m:page:unload",null,function(a){c("Stratcom").removeCurrentListener(),d("MDOM").setContent(b,"")}))}}function b(){var a=h();return a?Array.prototype.slice.call(a.childNodes):null}g.setup=a;g.getChromeHeaderRightContent=b}),98);
__d("MFirstPageRecorder",["$","Arbiter","MDOM","MDeepCopy","MPageCache","MPageController","MPageHeaderRight","MPageTitle","MRequestConfig","MResponseData","MURI","ScriptPath","ServerJS","Stratcom","ge"],(function(a,b,c,d,e,f,g){var h,i=!1,j=!1,k=[],l=new(c("MURI"))(d("MPageController").getRenderedPath()),m,n=[],o=[];({});var p=["m:chrome:schedulable-graph-search","first_response","last_response","MNotificationFlyoutContent","MMessegesFlyoutContent","MFriendRequestsFlyoutContent"];function q(){if(!m)return;c("MPageCache").setCachedPage(l,m);c("MPageCache").clearCachedIUIResponses(l);n.forEach(function(a){c("MPageCache").addCachedIUIResponse(l,a)});j=!0}function r(){if(i)return;i=!0;var a={ajax_response_token:c("MRequestConfig").ajaxResponseToken.secret,js:[],css:[],actions:[]},b=c("$")("root").cloneNode(!0),e=[];m=new(c("MResponseData"))({ajax_response_token:c("MRequestConfig").ajaxResponseToken.secret,js:[],css:[],actions:[{cmd:"script",type:"immediate",fn:function(){d("MDOM").replace(c("$")("root"),b.cloneNode(!0))}}]});var f=d("MPageHeaderRight").getChromeHeaderRightContent();f&&f.length>0&&e.push(function(){var a=document.createDocumentFragment();for(var b=0;b<f.length;b++)a.appendChild(f[0]);d("MPageHeaderRight").setup({node:a})});var g=document.title;e.push(function(){d("MPageTitle").setTitle(g)});var h=d("ScriptPath").getPageInfo();h&&e.push(function(){d("ScriptPath").set(h.scriptPath,h.categoryToken,h.extraData)});a.actions=e.map(function(a){return{cmd:"script",type:"onload",fn:a}});n.push(new(c("MResponseData"))(a))}function s(a,b,d){var e={ajax_response_token:c("MRequestConfig").ajaxResponseToken.secret,js:[],css:[],actions:[]};e.actions=Object.keys(a).map(function(b){return{cmd:"replace",target:b,html:a[b],replaceifexists:!1,allownull:!1}});b&&e.actions.push({cmd:"append",target:"static_templates",html:b,replaceifexists:!0});d&&e.actions.push({cmd:"script",type:"onload",fn:function(){new(c("ServerJS"))().handle(c("MDeepCopy")(d))}});r();n.push(new(c("MResponseData"))(e))}function t(a,b){if(!a||p.includes(a.id))return;j?(s(a.contentMap,a.staticTemplates,a.jsmods),c("MPageCache").addCachedIUIResponse(l,n.pop())):o.push(a)}function u(){m=null,i=!0}function v(){for(var a=0,b=o.length;a<b;a++)s(o[a].contentMap,o[a].staticTemplates,o[a].jsmods);q();o=[];n=[]}function a(a){if(h)return;h=!0;a;c("MPageCache").setPageCacheComplete(l,!0);var b=c("Arbiter").subscribe(["pagelet_performing_replayable_actions","pagelet_performing_replayable_actions_failed","all_pagelets_loaded"],function(b,c){switch(b){case"pagelet_performing_replayable_actions":t(c,a);break;case"pagelet_performing_replayable_actions_failed":u();break;case"all_pagelets_loaded":v();break}}),d=c("Arbiter").subscribe(["MRenderingScheduler/pageletSchedule","MRenderingScheduler/dd"],function(a,b){switch(a){case"MRenderingScheduler/pageletSchedule":if(b.pageletConfig.type==="content"){a=(a={},a[b.id]=b.element?c("ge")(b.element).innerHTML:b.content.__html,a);s(a,b.pageletConfig.templates.__html,c("MDeepCopy")(b.pageletConfig.serverJSData))}break;case"MRenderingScheduler/dd":q();break}});k=[b,d]}c("Stratcom").listen("m:page:unload",null,function(){k.forEach(function(a){a&&a.unsubscribe()}),k=[],h=!0,m=null,n=[],o=[],c("Stratcom").removeCurrentListener()});g.startPageletCaching=a}),98);
__d("MPageHeaderLeft",["$","MDOM","MFirefoxAppDetect"],(function(a,b,c,d,e,f,g){var h={};function i(a){if(!h.back_button){var b=c("$")("page");h.back_button=d("MDOM").find(b,"a","back-button");h.menu_button=d("MDOM").find(b,"a","menu-link")}a.show_back_button?(d("MDOM").hide(h.menu_button),d("MDOM").show(h.back_button)):(d("MDOM").hide(h.back_button),d("MDOM").show(h.menu_button))}function j(a){var b=window.navigator;b.standalone||h.isMozApp?i(a):h.isMozApp===void 0&&(h.lastConfig=a,d("MFirefoxAppDetect").isFirefoxApp(function(){h.isMozApp=!0,a===h.lastConfig&&(j(a),delete h.lastConfig)},function(){h.isMozApp=!1}))}g.main=j}),98);